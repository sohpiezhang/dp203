{
	"name": "Lab 5",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool01",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"754d70f4-7ac5-4dde-99bb-3576777609d8": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "64",
										"3": 4,
										"4": "31.280000000000000000",
										"5": "125.120000000000000000",
										"6": "20101231",
										"7": "38.760000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "64",
										"3": 3,
										"4": "31.280000000000000000",
										"5": "93.840000000000000000",
										"6": "20101231",
										"7": "29.070000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "64",
										"3": 2,
										"4": "31.280000000000000000",
										"5": "62.560000000000000000",
										"6": "20101231",
										"7": "19.380000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "3348",
										"3": 2,
										"4": "27.700000000000000000",
										"5": "55.400000000000000000",
										"6": "20101231",
										"7": "14.020000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "1470",
										"3": 1,
										"4": "29.140000000000000000",
										"5": "29.140000000000000000",
										"6": "20101231",
										"7": "9.170000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "1266",
										"3": 1,
										"4": "29.650000000000000000",
										"5": "29.650000000000000000",
										"6": "20101231",
										"7": "8.950000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "48",
										"3": 3,
										"4": "35.550000000000000000",
										"5": "106.650000000000000000",
										"6": "20101231",
										"7": "29.250000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "132",
										"3": 3,
										"4": "34.180000000000000000",
										"5": "102.540000000000000000",
										"6": "20101231",
										"7": "24.720000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "69",
										"3": 3,
										"4": "31.060000000000000000",
										"5": "93.180000000000000000",
										"6": "20101231",
										"7": "30.210000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									},
									{
										"0": "822ea5b1-15e1-4a89-a224-db5332f27b3e",
										"1": "10",
										"2": "203",
										"3": 3,
										"4": "31.690000000000000000",
										"5": "95.070000000000000000",
										"6": "20101231",
										"7": "28.050000000000000000",
										"8": 7,
										"9": 55,
										"10": "2020"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"2"
									],
									"seriesFieldKeys": [
										"5"
									],
									"isStacked": false
								}
							}
						}
					},
					"e912faf1-6d3e-4d80-be37-e2f50db37e8a": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "20101231",
										"1": "64",
										"2": "52975.230000000000000000",
										"3": "2.5547",
										"4": "5467"
									},
									{
										"0": "20101231",
										"1": "3348",
										"2": "1409.010000000000000000",
										"3": "2.4512",
										"4": "201"
									},
									{
										"0": "20101231",
										"1": "1470",
										"2": "1595.580000000000000000",
										"3": "2.6364",
										"4": "174"
									},
									{
										"0": "20101231",
										"1": "1266",
										"2": "10731.050000000000000000",
										"3": "2.5896",
										"4": "1199"
									},
									{
										"0": "20101231",
										"1": "48",
										"2": "39516.750000000000000000",
										"3": "2.5158",
										"4": "4053"
									},
									{
										"0": "20101231",
										"1": "132",
										"2": "42468.960000000000000000",
										"3": "2.4995",
										"4": "5154"
									},
									{
										"0": "20101231",
										"1": "69",
										"2": "41256.790000000000000000",
										"3": "2.4936",
										"4": "4097"
									},
									{
										"0": "20101231",
										"1": "203",
										"2": "46179.650000000000000000",
										"3": "2.4844",
										"4": "4939"
									},
									{
										"0": "20101231",
										"1": "8",
										"2": "27098.000000000000000000",
										"3": "2.4798",
										"4": "3985"
									},
									{
										"0": "20101231",
										"1": "4393",
										"2": "7880.040000000000000000",
										"3": "2.5226",
										"4": "1062"
									},
									{
										"0": "20101231",
										"1": "4650",
										"2": "6655.100000000000000000",
										"3": "2.5491",
										"4": "1091"
									},
									{
										"0": "20101231",
										"1": "629",
										"2": "9878.240000000000000000",
										"3": "2.4606",
										"4": "1154"
									},
									{
										"0": "20101231",
										"1": "2930",
										"2": "1170.000000000000000000",
										"3": "2.3284",
										"4": "156"
									},
									{
										"0": "20101231",
										"1": "2253",
										"2": "8232.000000000000000000",
										"3": "2.54",
										"4": "1176"
									},
									{
										"0": "20101231",
										"1": "3860",
										"2": "8627.520000000000000000",
										"3": "2.4731",
										"4": "1056"
									},
									{
										"0": "20101231",
										"1": "216",
										"2": "41157.540000000000000000",
										"3": "2.4973",
										"4": "5007"
									},
									{
										"0": "20101231",
										"1": "147",
										"2": "37010.530000000000000000",
										"3": "2.4916",
										"4": "5063"
									},
									{
										"0": "20101231",
										"1": "23",
										"2": "41280.030000000000000000",
										"3": "2.5009",
										"4": "4059"
									},
									{
										"0": "20101231",
										"1": "5",
										"2": "33314.600000000000000000",
										"3": "2.4792",
										"4": "4180"
									},
									{
										"0": "20101231",
										"1": "4626",
										"2": "7066.350000000000000000",
										"3": "2.5197",
										"4": "1149"
									},
									{
										"0": "20101231",
										"1": "692",
										"2": "7452.660000000000000000",
										"3": "2.4922",
										"4": "1114"
									},
									{
										"0": "20101231",
										"1": "1432",
										"2": "1963.520000000000000000",
										"3": "2.3111",
										"4": "208"
									},
									{
										"0": "20101231",
										"1": "755",
										"2": "8572.800000000000000000",
										"3": "2.5067",
										"4": "1128"
									},
									{
										"0": "20101231",
										"1": "84",
										"2": "30987.600000000000000000",
										"3": "2.5151",
										"4": "4165"
									},
									{
										"0": "20101231",
										"1": "213",
										"2": "29192.160000000000000000",
										"3": "2.4956",
										"4": "3988"
									},
									{
										"0": "20101231",
										"1": "74",
										"2": "31406.130000000000000000",
										"3": "2.479",
										"4": "4011"
									},
									{
										"0": "20101231",
										"1": "237",
										"2": "25826.740000000000000000",
										"3": "2.5567",
										"4": "4106"
									},
									{
										"0": "20101231",
										"1": "255",
										"2": "9264.000000000000000000",
										"3": "2.5065",
										"4": "3860"
									},
									{
										"0": "20101231",
										"1": "256",
										"2": "38895.570000000000000000",
										"3": "2.4963",
										"4": "4039"
									},
									{
										"0": "20101231",
										"1": "3038",
										"2": "11903.760000000000000000",
										"3": "2.5223",
										"4": "1188"
									},
									{
										"0": "20101231",
										"1": "4100",
										"2": "9885.920000000000000000",
										"3": "2.5972",
										"4": "1096"
									},
									{
										"0": "20101231",
										"1": "4569",
										"2": "2031.750000000000000000",
										"3": "2.52",
										"4": "189"
									},
									{
										"0": "20101231",
										"1": "3939",
										"2": "1849.200000000000000000",
										"3": "2.4731",
										"4": "230"
									},
									{
										"0": "20101231",
										"1": "4506",
										"2": "6338.710000000000000000",
										"3": "2.5255",
										"4": "1091"
									},
									{
										"0": "20101231",
										"1": "1173",
										"2": "8278.600000000000000000",
										"3": "2.4703",
										"4": "1166"
									},
									{
										"0": "20101231",
										"1": "684",
										"2": "1884.870000000000000000",
										"3": "2.2375",
										"4": "179"
									},
									{
										"0": "20101231",
										"1": "31",
										"2": "33544.910000000000000000",
										"3": "2.4766",
										"4": "4027"
									},
									{
										"0": "20101231",
										"1": "126",
										"2": "38938.800000000000000000",
										"3": "2.5576",
										"4": "4440"
									},
									{
										"0": "20101231",
										"1": "180",
										"2": "34710.870000000000000000",
										"3": "2.5285",
										"4": "4177"
									},
									{
										"0": "20101231",
										"1": "3006",
										"2": "8140.620000000000000000",
										"3": "2.4957",
										"4": "1173"
									},
									{
										"0": "20101231",
										"1": "4842",
										"2": "7760.160000000000000000",
										"3": "2.5565",
										"4": "1268"
									},
									{
										"0": "20101231",
										"1": "2854",
										"2": "6080.480000000000000000",
										"3": "2.44",
										"4": "976"
									},
									{
										"0": "20101231",
										"1": "3871",
										"2": "1390.080000000000000000",
										"3": "2.5857",
										"4": "181"
									},
									{
										"0": "20101231",
										"1": "254",
										"2": "42714.330000000000000000",
										"3": "2.4228",
										"4": "4143"
									},
									{
										"0": "20101231",
										"1": "4145",
										"2": "7927.500000000000000000",
										"3": "2.5301",
										"4": "1050"
									},
									{
										"0": "20101231",
										"1": "10",
										"2": "15652.980000000000000000",
										"3": "2.5371",
										"4": "4242"
									},
									{
										"0": "20101231",
										"1": "182",
										"2": "44954.800000000000000000",
										"3": "2.5356",
										"4": "3740"
									},
									{
										"0": "20101231",
										"1": "82",
										"2": "38008.320000000000000000",
										"3": "2.4938",
										"4": "4242"
									},
									{
										"0": "20101231",
										"1": "202",
										"2": "26960.790000000000000000",
										"3": "2.4962",
										"4": "3959"
									},
									{
										"0": "20101231",
										"1": "121",
										"2": "26743.080000000000000000",
										"3": "2.5064",
										"4": "4108"
									},
									{
										"0": "20101231",
										"1": "4166",
										"2": "9706.320000000000000000",
										"3": "2.4868",
										"4": "1037"
									},
									{
										"0": "20101231",
										"1": "942",
										"2": "13101.790000000000000000",
										"3": "2.5341",
										"4": "1039"
									},
									{
										"0": "20101231",
										"1": "4151",
										"2": "11817.260000000000000000",
										"3": "2.5227",
										"4": "1057"
									},
									{
										"0": "20101231",
										"1": "2364",
										"2": "2010.560000000000000000",
										"3": "2.6076",
										"4": "206"
									},
									{
										"0": "20101231",
										"1": "1064",
										"2": "1144.500000000000000000",
										"3": "2.2245",
										"4": "109"
									},
									{
										"0": "20101231",
										"1": "2077",
										"2": "2445.300000000000000000",
										"3": "2.6292",
										"4": "234"
									},
									{
										"0": "20101231",
										"1": "1468",
										"2": "7920.500000000000000000",
										"3": "2.4548",
										"4": "1085"
									},
									{
										"0": "20101231",
										"1": "4698",
										"2": "8542.160000000000000000",
										"3": "2.4989",
										"4": "1142"
									},
									{
										"0": "20101231",
										"1": "1483",
										"2": "9514.900000000000000000",
										"3": "2.4836",
										"4": "986"
									},
									{
										"0": "20101231",
										"1": "4207",
										"2": "1661.650000000000000000",
										"3": "2.5513",
										"4": "199"
									},
									{
										"0": "20101231",
										"1": "136",
										"2": "27390.720000000000000000",
										"3": "2.5459",
										"4": "4076"
									},
									{
										"0": "20101231",
										"1": "189",
										"2": "38838.800000000000000000",
										"3": "2.5025",
										"4": "4004"
									},
									{
										"0": "20101231",
										"1": "73",
										"2": "44844.550000000000000000",
										"3": "2.5105",
										"4": "4195"
									},
									{
										"0": "20101231",
										"1": "194",
										"2": "37475.490000000000000000",
										"3": "2.4917",
										"4": "4069"
									},
									{
										"0": "20101231",
										"1": "14",
										"2": "34693.120000000000000000",
										"3": "2.4779",
										"4": "4096"
									},
									{
										"0": "20101231",
										"1": "959",
										"2": "8901.880000000000000000",
										"3": "2.4442",
										"4": "1007"
									},
									{
										"0": "20101231",
										"1": "4855",
										"2": "1299.960000000000000000",
										"3": "2.3",
										"4": "207"
									},
									{
										"0": "20101231",
										"1": "46",
										"2": "36986.400000000000000000",
										"3": "2.5319",
										"4": "4203"
									},
									{
										"0": "20101231",
										"1": "218",
										"2": "25815.480000000000000000",
										"3": "2.5065",
										"4": "5003"
									},
									{
										"0": "20101231",
										"1": "1873",
										"2": "9276.930000000000000000",
										"3": "2.4488",
										"4": "1053"
									},
									{
										"0": "20101231",
										"1": "861",
										"2": "5864.170000000000000000",
										"3": "2.4807",
										"4": "1027"
									},
									{
										"0": "20101231",
										"1": "3766",
										"2": "8670.750000000000000000",
										"3": "2.5325",
										"4": "1051"
									},
									{
										"0": "20101231",
										"1": "3180",
										"2": "1468.850000000000000000",
										"3": "2.3387",
										"4": "145"
									},
									{
										"0": "20101231",
										"1": "2716",
										"2": "9500.380000000000000000",
										"3": "2.4049",
										"4": "1087"
									},
									{
										"0": "20101231",
										"1": "358",
										"2": "11928.000000000000000000",
										"3": "2.4615",
										"4": "1120"
									},
									{
										"0": "20101231",
										"1": "9",
										"2": "38547.600000000000000000",
										"3": "2.5071",
										"4": "5295"
									},
									{
										"0": "20101231",
										"1": "33",
										"2": "31783.600000000000000000",
										"3": "2.5172",
										"4": "4390"
									},
									{
										"0": "20101231",
										"1": "138",
										"2": "33537.660000000000000000",
										"3": "2.4768",
										"4": "4161"
									},
									{
										"0": "20101231",
										"1": "96",
										"2": "66600.400000000000000000",
										"3": "2.5294",
										"4": "5084"
									},
									{
										"0": "20101231",
										"1": "777",
										"2": "5834.780000000000000000",
										"3": "2.5038",
										"4": "994"
									},
									{
										"0": "20101231",
										"1": "4331",
										"2": "1989.120000000000000000",
										"3": "2.6701",
										"4": "259"
									},
									{
										"0": "20101231",
										"1": "3735",
										"2": "10738.480000000000000000",
										"3": "2.5082",
										"4": "1076"
									},
									{
										"0": "20101231",
										"1": "3775",
										"2": "12616.950000000000000000",
										"3": "2.5363",
										"4": "1083"
									},
									{
										"0": "20101231",
										"1": "29",
										"2": "43124.550000000000000000",
										"3": "2.5167",
										"4": "4291"
									},
									{
										"0": "20101231",
										"1": "113",
										"2": "27276.060000000000000000",
										"3": "2.516",
										"4": "4242"
									},
									{
										"0": "20101231",
										"1": "249",
										"2": "40038.570000000000000000",
										"3": "2.475",
										"4": "3861"
									},
									{
										"0": "20101231",
										"1": "2052",
										"2": "8540.800000000000000000",
										"3": "2.4505",
										"4": "1088"
									},
									{
										"0": "20101231",
										"1": "2717",
										"2": "1724.160000000000000000",
										"3": "2.56",
										"4": "192"
									},
									{
										"0": "20101231",
										"1": "4305",
										"2": "1357.900000000000000000",
										"3": "2.3718",
										"4": "185"
									},
									{
										"0": "20101231",
										"1": "1854",
										"2": "9950.280000000000000000",
										"3": "2.5368",
										"4": "1172"
									},
									{
										"0": "20101231",
										"1": "3331",
										"2": "7570.200000000000000000",
										"3": "2.4183",
										"4": "1110"
									},
									{
										"0": "20101231",
										"1": "403",
										"2": "1590.800000000000000000",
										"3": "2.3563",
										"4": "205"
									},
									{
										"0": "20101231",
										"1": "230",
										"2": "36581.000000000000000000",
										"3": "2.4795",
										"4": "3925"
									},
									{
										"0": "20101231",
										"1": "151",
										"2": "39321.750000000000000000",
										"3": "2.5317",
										"4": "4033"
									},
									{
										"0": "20101231",
										"1": "155",
										"2": "30213.120000000000000000",
										"3": "2.5105",
										"4": "3934"
									},
									{
										"0": "20101231",
										"1": "1635",
										"2": "9359.520000000000000000",
										"3": "2.4667",
										"4": "1147"
									},
									{
										"0": "20101231",
										"1": "1825",
										"2": "9048.900000000000000000",
										"3": "2.5233",
										"4": "1085"
									},
									{
										"0": "20101231",
										"1": "633",
										"2": "11240.400000000000000000",
										"3": "2.4061",
										"4": "1102"
									},
									{
										"0": "20101231",
										"1": "2995",
										"2": "908.040000000000000000",
										"3": "2.3115",
										"4": "141"
									},
									{
										"0": "20101231",
										"1": "3074",
										"2": "2727.290000000000000000",
										"3": "2.5341",
										"4": "223"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "1",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "2",
										"name": "(sum)ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "(avg)Quantity",
										"type": "double"
									},
									{
										"key": "4",
										"name": "(sum)Quantity",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"55400812-a5d9-4b2a-acb4-43ece8da5ff8": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "101795",
										"1": "2842",
										"2": "1"
									},
									{
										"0": "102738",
										"1": "4213",
										"2": "1"
									},
									{
										"0": "101820",
										"1": "1860",
										"2": "1"
									},
									{
										"0": "101007",
										"1": "4395",
										"2": "1"
									},
									{
										"0": "101831",
										"1": "1404",
										"2": "1"
									},
									{
										"0": "101038",
										"1": "1962",
										"2": "1"
									},
									{
										"0": "101835",
										"1": "2703",
										"2": "1"
									},
									{
										"0": "101034",
										"1": "3840",
										"2": "1"
									},
									{
										"0": "101835",
										"1": "1677",
										"2": "1"
									},
									{
										"0": "101045",
										"1": "2693",
										"2": "1"
									},
									{
										"0": "101838",
										"1": "2981",
										"2": "1"
									},
									{
										"0": "101060",
										"1": "1853",
										"2": "1"
									},
									{
										"0": "101842",
										"1": "826",
										"2": "1"
									},
									{
										"0": "101083",
										"1": "4415",
										"2": "1"
									},
									{
										"0": "101858",
										"1": "3274",
										"2": "1"
									},
									{
										"0": "101121",
										"1": "4989",
										"2": "1"
									},
									{
										"0": "101859",
										"1": "1412",
										"2": "1"
									},
									{
										"0": "101143",
										"1": "4040",
										"2": "1"
									},
									{
										"0": "101865",
										"1": "2207",
										"2": "1"
									},
									{
										"0": "101157",
										"1": "4247",
										"2": "1"
									},
									{
										"0": "101876",
										"1": "4026",
										"2": "1"
									},
									{
										"0": "101177",
										"1": "1895",
										"2": "1"
									},
									{
										"0": "101878",
										"1": "937",
										"2": "1"
									},
									{
										"0": "101185",
										"1": "383",
										"2": "1"
									},
									{
										"0": "101890",
										"1": "2764",
										"2": "1"
									},
									{
										"0": "101225",
										"1": "1853",
										"2": "1"
									},
									{
										"0": "101890",
										"1": "3262",
										"2": "1"
									},
									{
										"0": "101242",
										"1": "4440",
										"2": "1"
									},
									{
										"0": "101901",
										"1": "2511",
										"2": "1"
									},
									{
										"0": "101269",
										"1": "2277",
										"2": "1"
									},
									{
										"0": "101901",
										"1": "3302",
										"2": "1"
									},
									{
										"0": "101288",
										"1": "4723",
										"2": "1"
									},
									{
										"0": "101910",
										"1": "168",
										"2": "1"
									},
									{
										"0": "101297",
										"1": "1737",
										"2": "1"
									},
									{
										"0": "101912",
										"1": "1876",
										"2": "1"
									},
									{
										"0": "101327",
										"1": "644",
										"2": "1"
									},
									{
										"0": "101923",
										"1": "4198",
										"2": "1"
									},
									{
										"0": "101790",
										"1": "1467",
										"2": "1"
									},
									{
										"0": "101935",
										"1": "4056",
										"2": "1"
									},
									{
										"0": "101359",
										"1": "1384",
										"2": "1"
									},
									{
										"0": "101938",
										"1": "3473",
										"2": "1"
									},
									{
										"0": "101383",
										"1": "2217",
										"2": "1"
									},
									{
										"0": "101951",
										"1": "431",
										"2": "1"
									},
									{
										"0": "101412",
										"1": "3287",
										"2": "1"
									},
									{
										"0": "101965",
										"1": "1153",
										"2": "1"
									},
									{
										"0": "101438",
										"1": "2392",
										"2": "1"
									},
									{
										"0": "101983",
										"1": "66",
										"2": "1"
									},
									{
										"0": "101466",
										"1": "4630",
										"2": "1"
									},
									{
										"0": "102006",
										"1": "3884",
										"2": "1"
									},
									{
										"0": "101499",
										"1": "932",
										"2": "1"
									},
									{
										"0": "102031",
										"1": "2984",
										"2": "1"
									},
									{
										"0": "101519",
										"1": "2718",
										"2": "1"
									},
									{
										"0": "102038",
										"1": "3384",
										"2": "1"
									},
									{
										"0": "101552",
										"1": "1113",
										"2": "1"
									},
									{
										"0": "102062",
										"1": "1143",
										"2": "1"
									},
									{
										"0": "101560",
										"1": "1452",
										"2": "1"
									},
									{
										"0": "102079",
										"1": "4449",
										"2": "1"
									},
									{
										"0": "101572",
										"1": "1330",
										"2": "1"
									},
									{
										"0": "102096",
										"1": "4955",
										"2": "1"
									},
									{
										"0": "101585",
										"1": "3317",
										"2": "1"
									},
									{
										"0": "102096",
										"1": "4936",
										"2": "1"
									},
									{
										"0": "101587",
										"1": "3663",
										"2": "1"
									},
									{
										"0": "102105",
										"1": "3171",
										"2": "1"
									},
									{
										"0": "101592",
										"1": "1286",
										"2": "1"
									},
									{
										"0": "102112",
										"1": "2916",
										"2": "1"
									},
									{
										"0": "101619",
										"1": "1982",
										"2": "1"
									},
									{
										"0": "102120",
										"1": "4255",
										"2": "1"
									},
									{
										"0": "101624",
										"1": "2126",
										"2": "1"
									},
									{
										"0": "102120",
										"1": "543",
										"2": "1"
									},
									{
										"0": "101658",
										"1": "606",
										"2": "1"
									},
									{
										"0": "102138",
										"1": "1937",
										"2": "1"
									},
									{
										"0": "101684",
										"1": "82",
										"2": "1"
									},
									{
										"0": "102144",
										"1": "4990",
										"2": "1"
									},
									{
										"0": "101696",
										"1": "437",
										"2": "1"
									},
									{
										"0": "102158",
										"1": "3430",
										"2": "1"
									},
									{
										"0": "101712",
										"1": "4114",
										"2": "1"
									},
									{
										"0": "102180",
										"1": "819",
										"2": "1"
									},
									{
										"0": "101721",
										"1": "1356",
										"2": "1"
									},
									{
										"0": "102204",
										"1": "697",
										"2": "1"
									},
									{
										"0": "101726",
										"1": "105",
										"2": "1"
									},
									{
										"0": "102206",
										"1": "986",
										"2": "1"
									},
									{
										"0": "101759",
										"1": "796",
										"2": "1"
									},
									{
										"0": "102212",
										"1": "1165",
										"2": "1"
									},
									{
										"0": "101789",
										"1": "4732",
										"2": "1"
									},
									{
										"0": "102228",
										"1": "3509",
										"2": "1"
									},
									{
										"0": "102311",
										"1": "536",
										"2": "1"
									},
									{
										"0": "102333",
										"1": "3924",
										"2": "1"
									},
									{
										"0": "101003",
										"1": "1823",
										"2": "1"
									},
									{
										"0": "102334",
										"1": "4714",
										"2": "1"
									},
									{
										"0": "101031",
										"1": "4784",
										"2": "1"
									},
									{
										"0": "102335",
										"1": "4322",
										"2": "1"
									},
									{
										"0": "101051",
										"1": "3236",
										"2": "1"
									},
									{
										"0": "102344",
										"1": "2944",
										"2": "1"
									},
									{
										"0": "101096",
										"1": "2361",
										"2": "1"
									},
									{
										"0": "102364",
										"1": "2850",
										"2": "1"
									},
									{
										"0": "101339",
										"1": "3863",
										"2": "1"
									},
									{
										"0": "102364",
										"1": "4526",
										"2": "1"
									},
									{
										"0": "101184",
										"1": "512",
										"2": "1"
									},
									{
										"0": "102367",
										"1": "217",
										"2": "1"
									},
									{
										"0": "101230",
										"1": "4447",
										"2": "1"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"577538ed-a492-4ca9-adf6-72c56c2225c3": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "101939",
										"1": "4398",
										"2": "99"
									},
									{
										"0": "102925",
										"1": "758",
										"2": "99"
									},
									{
										"0": "101962",
										"1": "1369",
										"2": "99"
									},
									{
										"0": "101012",
										"1": "4603",
										"2": "99"
									},
									{
										"0": "101966",
										"1": "1949",
										"2": "99"
									},
									{
										"0": "101091",
										"1": "4846",
										"2": "99"
									},
									{
										"0": "101966",
										"1": "2493",
										"2": "99"
									},
									{
										"0": "101111",
										"1": "4732",
										"2": "99"
									},
									{
										"0": "101983",
										"1": "1158",
										"2": "99"
									},
									{
										"0": "101122",
										"1": "4663",
										"2": "99"
									},
									{
										"0": "101989",
										"1": "409",
										"2": "99"
									},
									{
										"0": "101155",
										"1": "3343",
										"2": "99"
									},
									{
										"0": "101990",
										"1": "835",
										"2": "99"
									},
									{
										"0": "101159",
										"1": "2988",
										"2": "99"
									},
									{
										"0": "101991",
										"1": "531",
										"2": "99"
									},
									{
										"0": "101202",
										"1": "3120",
										"2": "99"
									},
									{
										"0": "102002",
										"1": "4182",
										"2": "99"
									},
									{
										"0": "101223",
										"1": "3364",
										"2": "99"
									},
									{
										"0": "102004",
										"1": "4300",
										"2": "99"
									},
									{
										"0": "101252",
										"1": "4690",
										"2": "99"
									},
									{
										"0": "102006",
										"1": "3837",
										"2": "99"
									},
									{
										"0": "101302",
										"1": "4152",
										"2": "99"
									},
									{
										"0": "102013",
										"1": "1334",
										"2": "99"
									},
									{
										"0": "101325",
										"1": "855",
										"2": "99"
									},
									{
										"0": "102013",
										"1": "1575",
										"2": "99"
									},
									{
										"0": "101347",
										"1": "25",
										"2": "99"
									},
									{
										"0": "102014",
										"1": "287",
										"2": "99"
									},
									{
										"0": "101357",
										"1": "4171",
										"2": "99"
									},
									{
										"0": "102020",
										"1": "4882",
										"2": "99"
									},
									{
										"0": "101393",
										"1": "1265",
										"2": "99"
									},
									{
										"0": "102024",
										"1": "4791",
										"2": "99"
									},
									{
										"0": "101452",
										"1": "1788",
										"2": "99"
									},
									{
										"0": "102026",
										"1": "903",
										"2": "99"
									},
									{
										"0": "101477",
										"1": "13",
										"2": "99"
									},
									{
										"0": "102032",
										"1": "4207",
										"2": "99"
									},
									{
										"0": "101486",
										"1": "2121",
										"2": "99"
									},
									{
										"0": "102059",
										"1": "1098",
										"2": "99"
									},
									{
										"0": "101490",
										"1": "262",
										"2": "99"
									},
									{
										"0": "102063",
										"1": "1768",
										"2": "99"
									},
									{
										"0": "101504",
										"1": "4632",
										"2": "99"
									},
									{
										"0": "102069",
										"1": "4098",
										"2": "99"
									},
									{
										"0": "101537",
										"1": "2211",
										"2": "99"
									},
									{
										"0": "102089",
										"1": "4957",
										"2": "99"
									},
									{
										"0": "101564",
										"1": "2269",
										"2": "99"
									},
									{
										"0": "102096",
										"1": "2206",
										"2": "99"
									},
									{
										"0": "101577",
										"1": "1186",
										"2": "99"
									},
									{
										"0": "102111",
										"1": "3631",
										"2": "99"
									},
									{
										"0": "101600",
										"1": "4773",
										"2": "99"
									},
									{
										"0": "102123",
										"1": "4104",
										"2": "99"
									},
									{
										"0": "101608",
										"1": "4006",
										"2": "99"
									},
									{
										"0": "102130",
										"1": "4185",
										"2": "99"
									},
									{
										"0": "101623",
										"1": "4341",
										"2": "99"
									},
									{
										"0": "102153",
										"1": "2325",
										"2": "99"
									},
									{
										"0": "101641",
										"1": "2165",
										"2": "99"
									},
									{
										"0": "102172",
										"1": "3035",
										"2": "99"
									},
									{
										"0": "101664",
										"1": "1251",
										"2": "99"
									},
									{
										"0": "102201",
										"1": "1596",
										"2": "99"
									},
									{
										"0": "101677",
										"1": "4250",
										"2": "99"
									},
									{
										"0": "102203",
										"1": "1142",
										"2": "99"
									},
									{
										"0": "101692",
										"1": "3546",
										"2": "99"
									},
									{
										"0": "102209",
										"1": "1435",
										"2": "99"
									},
									{
										"0": "101699",
										"1": "3461",
										"2": "99"
									},
									{
										"0": "102210",
										"1": "1701",
										"2": "99"
									},
									{
										"0": "101711",
										"1": "566",
										"2": "99"
									},
									{
										"0": "102225",
										"1": "3208",
										"2": "99"
									},
									{
										"0": "101738",
										"1": "2956",
										"2": "99"
									},
									{
										"0": "102225",
										"1": "2752",
										"2": "99"
									},
									{
										"0": "101767",
										"1": "2658",
										"2": "99"
									},
									{
										"0": "102248",
										"1": "2200",
										"2": "99"
									},
									{
										"0": "101796",
										"1": "3720",
										"2": "99"
									},
									{
										"0": "102261",
										"1": "3410",
										"2": "99"
									},
									{
										"0": "101837",
										"1": "1824",
										"2": "99"
									},
									{
										"0": "102265",
										"1": "566",
										"2": "99"
									},
									{
										"0": "101847",
										"1": "1876",
										"2": "99"
									},
									{
										"0": "102276",
										"1": "2386",
										"2": "99"
									},
									{
										"0": "101879",
										"1": "1679",
										"2": "99"
									},
									{
										"0": "102289",
										"1": "2680",
										"2": "99"
									},
									{
										"0": "101885",
										"1": "1190",
										"2": "99"
									},
									{
										"0": "102297",
										"1": "2659",
										"2": "99"
									},
									{
										"0": "101906",
										"1": "3758",
										"2": "99"
									},
									{
										"0": "102298",
										"1": "3422",
										"2": "99"
									},
									{
										"0": "102379",
										"1": "4134",
										"2": "99"
									},
									{
										"0": "102380",
										"1": "1184",
										"2": "99"
									},
									{
										"0": "101178",
										"1": "3204",
										"2": "99"
									},
									{
										"0": "102387",
										"1": "1908",
										"2": "99"
									},
									{
										"0": "101095",
										"1": "1986",
										"2": "99"
									},
									{
										"0": "102393",
										"1": "209",
										"2": "99"
									},
									{
										"0": "101143",
										"1": "2416",
										"2": "99"
									},
									{
										"0": "102405",
										"1": "642",
										"2": "99"
									},
									{
										"0": "101160",
										"1": "1336",
										"2": "99"
									},
									{
										"0": "102418",
										"1": "2337",
										"2": "99"
									},
									{
										"0": "101242",
										"1": "2549",
										"2": "99"
									},
									{
										"0": "102442",
										"1": "4806",
										"2": "99"
									},
									{
										"0": "101325",
										"1": "3579",
										"2": "99"
									},
									{
										"0": "102458",
										"1": "2671",
										"2": "99"
									},
									{
										"0": "101349",
										"1": "1175",
										"2": "99"
									},
									{
										"0": "102470",
										"1": "3389",
										"2": "99"
									},
									{
										"0": "101400",
										"1": "2257",
										"2": "99"
									},
									{
										"0": "102486",
										"1": "2900",
										"2": "99"
									},
									{
										"0": "101481",
										"1": "1375",
										"2": "99"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"50774fa1-2dce-483b-9832-a2ee634d0267": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "20"
									},
									{
										"0": "80001",
										"1": "20"
									},
									{
										"0": "80002",
										"1": "15"
									},
									{
										"0": "80003",
										"1": "12"
									},
									{
										"0": "80004",
										"1": "10"
									},
									{
										"0": "80005",
										"1": "13"
									},
									{
										"0": "80006",
										"1": "6"
									},
									{
										"0": "80007",
										"1": "18"
									},
									{
										"0": "80008",
										"1": "4"
									},
									{
										"0": "80009",
										"1": "16"
									},
									{
										"0": "80010",
										"1": "3"
									},
									{
										"0": "80011",
										"1": "17"
									},
									{
										"0": "80012",
										"1": "19"
									},
									{
										"0": "80013",
										"1": "6"
									},
									{
										"0": "80014",
										"1": "20"
									},
									{
										"0": "80015",
										"1": "12"
									},
									{
										"0": "80016",
										"1": "6"
									},
									{
										"0": "80017",
										"1": "1"
									},
									{
										"0": "80018",
										"1": "17"
									},
									{
										"0": "80019",
										"1": "14"
									},
									{
										"0": "80020",
										"1": "9"
									},
									{
										"0": "80021",
										"1": "18"
									},
									{
										"0": "80022",
										"1": "13"
									},
									{
										"0": "80023",
										"1": "10"
									},
									{
										"0": "80024",
										"1": "4"
									},
									{
										"0": "80025",
										"1": "13"
									},
									{
										"0": "80026",
										"1": "19"
									},
									{
										"0": "80027",
										"1": "13"
									},
									{
										"0": "80028",
										"1": "1"
									},
									{
										"0": "80029",
										"1": "4"
									},
									{
										"0": "80030",
										"1": "1"
									},
									{
										"0": "80031",
										"1": "9"
									},
									{
										"0": "80032",
										"1": "17"
									},
									{
										"0": "80033",
										"1": "8"
									},
									{
										"0": "80034",
										"1": "14"
									},
									{
										"0": "80035",
										"1": "11"
									},
									{
										"0": "80036",
										"1": "19"
									},
									{
										"0": "80037",
										"1": "10"
									},
									{
										"0": "80038",
										"1": "3"
									},
									{
										"0": "80039",
										"1": "4"
									},
									{
										"0": "80040",
										"1": "17"
									},
									{
										"0": "80041",
										"1": "6"
									},
									{
										"0": "80042",
										"1": "9"
									},
									{
										"0": "80043",
										"1": "2"
									},
									{
										"0": "80044",
										"1": "19"
									},
									{
										"0": "80045",
										"1": "6"
									},
									{
										"0": "80046",
										"1": "17"
									},
									{
										"0": "80047",
										"1": "4"
									},
									{
										"0": "80048",
										"1": "13"
									},
									{
										"0": "80049",
										"1": "16"
									},
									{
										"0": "80050",
										"1": "5"
									},
									{
										"0": "80051",
										"1": "17"
									},
									{
										"0": "80052",
										"1": "9"
									},
									{
										"0": "80053",
										"1": "4"
									},
									{
										"0": "80054",
										"1": "10"
									},
									{
										"0": "80055",
										"1": "18"
									},
									{
										"0": "80056",
										"1": "13"
									},
									{
										"0": "80057",
										"1": "9"
									},
									{
										"0": "80058",
										"1": "3"
									},
									{
										"0": "80059",
										"1": "14"
									},
									{
										"0": "80060",
										"1": "4"
									},
									{
										"0": "80061",
										"1": "6"
									},
									{
										"0": "80062",
										"1": "19"
									},
									{
										"0": "80063",
										"1": "3"
									},
									{
										"0": "80064",
										"1": "3"
									},
									{
										"0": "80066",
										"1": "4"
									},
									{
										"0": "80067",
										"1": "6"
									},
									{
										"0": "80068",
										"1": "5"
									},
									{
										"0": "80069",
										"1": "11"
									},
									{
										"0": "80070",
										"1": "8"
									},
									{
										"0": "80071",
										"1": "8"
									},
									{
										"0": "80072",
										"1": "5"
									},
									{
										"0": "80073",
										"1": "14"
									},
									{
										"0": "80074",
										"1": "12"
									},
									{
										"0": "80075",
										"1": "7"
									},
									{
										"0": "80076",
										"1": "12"
									},
									{
										"0": "80077",
										"1": "1"
									},
									{
										"0": "80078",
										"1": "6"
									},
									{
										"0": "80079",
										"1": "4"
									},
									{
										"0": "80080",
										"1": "19"
									},
									{
										"0": "80081",
										"1": "14"
									},
									{
										"0": "80082",
										"1": "15"
									},
									{
										"0": "80083",
										"1": "12"
									},
									{
										"0": "80084",
										"1": "5"
									},
									{
										"0": "80086",
										"1": "7"
									},
									{
										"0": "80087",
										"1": "1"
									},
									{
										"0": "80088",
										"1": "2"
									},
									{
										"0": "80089",
										"1": "9"
									},
									{
										"0": "80090",
										"1": "1"
									},
									{
										"0": "80091",
										"1": "10"
									},
									{
										"0": "80092",
										"1": "11"
									},
									{
										"0": "80093",
										"1": "6"
									},
									{
										"0": "80094",
										"1": "19"
									},
									{
										"0": "80095",
										"1": "1"
									},
									{
										"0": "80096",
										"1": "19"
									},
									{
										"0": "80097",
										"1": "19"
									},
									{
										"0": "80098",
										"1": "15"
									},
									{
										"0": "80099",
										"1": "8"
									},
									{
										"0": "80100",
										"1": "11"
									},
									{
										"0": "80101",
										"1": "6"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "total",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"d12c8d91-7104-422e-b2da-3c159656c0a9": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "1054"
									},
									{
										"0": "80001",
										"1": "834"
									},
									{
										"0": "80002",
										"1": "754"
									},
									{
										"0": "80003",
										"1": "684"
									},
									{
										"0": "80004",
										"1": "598"
									},
									{
										"0": "80005",
										"1": "615"
									},
									{
										"0": "80006",
										"1": "348"
									},
									{
										"0": "80007",
										"1": "932"
									},
									{
										"0": "80008",
										"1": "199"
									},
									{
										"0": "80009",
										"1": "787"
									},
									{
										"0": "80010",
										"1": "97"
									},
									{
										"0": "80011",
										"1": "931"
									},
									{
										"0": "80012",
										"1": "1042"
									},
									{
										"0": "80013",
										"1": "313"
									},
									{
										"0": "80014",
										"1": "1084"
									},
									{
										"0": "80015",
										"1": "496"
									},
									{
										"0": "80016",
										"1": "429"
									},
									{
										"0": "80017",
										"1": "76"
									},
									{
										"0": "80018",
										"1": "733"
									},
									{
										"0": "80019",
										"1": "743"
									},
									{
										"0": "80020",
										"1": "502"
									},
									{
										"0": "80021",
										"1": "921"
									},
									{
										"0": "80022",
										"1": "662"
									},
									{
										"0": "80023",
										"1": "461"
									},
									{
										"0": "80024",
										"1": "143"
									},
									{
										"0": "80025",
										"1": "747"
									},
									{
										"0": "80026",
										"1": "909"
									},
									{
										"0": "80027",
										"1": "681"
									},
									{
										"0": "80028",
										"1": "72"
									},
									{
										"0": "80029",
										"1": "227"
									},
									{
										"0": "80030",
										"1": "4"
									},
									{
										"0": "80031",
										"1": "654"
									},
									{
										"0": "80032",
										"1": "877"
									},
									{
										"0": "80033",
										"1": "331"
									},
									{
										"0": "80034",
										"1": "651"
									},
									{
										"0": "80035",
										"1": "496"
									},
									{
										"0": "80036",
										"1": "1045"
									},
									{
										"0": "80037",
										"1": "476"
									},
									{
										"0": "80038",
										"1": "139"
									},
									{
										"0": "80039",
										"1": "211"
									},
									{
										"0": "80040",
										"1": "913"
									},
									{
										"0": "80041",
										"1": "290"
									},
									{
										"0": "80042",
										"1": "427"
									},
									{
										"0": "80043",
										"1": "24"
									},
									{
										"0": "80044",
										"1": "728"
									},
									{
										"0": "80045",
										"1": "314"
									},
									{
										"0": "80046",
										"1": "613"
									},
									{
										"0": "80047",
										"1": "194"
									},
									{
										"0": "80048",
										"1": "708"
									},
									{
										"0": "80049",
										"1": "981"
									},
									{
										"0": "80050",
										"1": "234"
									},
									{
										"0": "80051",
										"1": "788"
									},
									{
										"0": "80052",
										"1": "395"
									},
									{
										"0": "80053",
										"1": "234"
									},
									{
										"0": "80054",
										"1": "391"
									},
									{
										"0": "80055",
										"1": "1137"
									},
									{
										"0": "80056",
										"1": "440"
									},
									{
										"0": "80057",
										"1": "474"
									},
									{
										"0": "80058",
										"1": "50"
									},
									{
										"0": "80059",
										"1": "677"
									},
									{
										"0": "80060",
										"1": "158"
									},
									{
										"0": "80061",
										"1": "212"
									},
									{
										"0": "80062",
										"1": "1009"
									},
									{
										"0": "80063",
										"1": "113"
									},
									{
										"0": "80064",
										"1": "132"
									},
									{
										"0": "80066",
										"1": "141"
									},
									{
										"0": "80067",
										"1": "381"
									},
									{
										"0": "80068",
										"1": "329"
									},
									{
										"0": "80069",
										"1": "524"
									},
									{
										"0": "80070",
										"1": "422"
									},
									{
										"0": "80071",
										"1": "322"
									},
									{
										"0": "80072",
										"1": "352"
									},
									{
										"0": "80073",
										"1": "770"
									},
									{
										"0": "80074",
										"1": "398"
									},
									{
										"0": "80075",
										"1": "185"
									},
									{
										"0": "80076",
										"1": "425"
									},
									{
										"0": "80077",
										"1": "84"
									},
									{
										"0": "80078",
										"1": "383"
									},
									{
										"0": "80079",
										"1": "250"
									},
									{
										"0": "80080",
										"1": "946"
									},
									{
										"0": "80081",
										"1": "540"
									},
									{
										"0": "80082",
										"1": "566"
									},
									{
										"0": "80083",
										"1": "726"
									},
									{
										"0": "80084",
										"1": "257"
									},
									{
										"0": "80086",
										"1": "270"
									},
									{
										"0": "80087",
										"1": "20"
									},
									{
										"0": "80088",
										"1": "27"
									},
									{
										"0": "80089",
										"1": "488"
									},
									{
										"0": "80090",
										"1": "34"
									},
									{
										"0": "80091",
										"1": "314"
									},
									{
										"0": "80092",
										"1": "535"
									},
									{
										"0": "80093",
										"1": "279"
									},
									{
										"0": "80094",
										"1": "937"
									},
									{
										"0": "80095",
										"1": "42"
									},
									{
										"0": "80096",
										"1": "807"
									},
									{
										"0": "80097",
										"1": "984"
									},
									{
										"0": "80098",
										"1": "744"
									},
									{
										"0": "80099",
										"1": "375"
									},
									{
										"0": "80100",
										"1": "510"
									},
									{
										"0": "80101",
										"1": "222"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "totalItemsPurchased",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"2f8db5e4-0d56-4fca-be65-16fc658e5ddc": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "820",
										"3": 2,
										"4": "33.280000000000000000",
										"5": "66.560000000000000000",
										"6": "20191204",
										"7": "22.660000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "1370",
										"3": 2,
										"4": "26.660000000000000000",
										"5": "53.320000000000000000",
										"6": "20191204",
										"7": "16.580000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "3071",
										"3": 1,
										"4": "39.220000000000000000",
										"5": "39.220000000000000000",
										"6": "20191204",
										"7": "12.380000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "3460",
										"3": 4,
										"4": "30.840000000000000000",
										"5": "123.360000000000000000",
										"6": "20191204",
										"7": "42.720000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "2975",
										"3": 1,
										"4": "33.240000000000000000",
										"5": "33.240000000000000000",
										"6": "20191204",
										"7": "11.190000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "4889",
										"3": 2,
										"4": "32.020000000000000000",
										"5": "64.040000000000000000",
										"6": "20191204",
										"7": "20.200000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "2333",
										"3": 1,
										"4": "19.220000000000000000",
										"5": "19.220000000000000000",
										"6": "20191204",
										"7": "5.540000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "105",
										"3": 1,
										"4": "34.360000000000000000",
										"5": "34.360000000000000000",
										"6": "20191204",
										"7": "10.510000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "6",
										"3": 1,
										"4": "28.310000000000000000",
										"5": "28.310000000000000000",
										"6": "20191204",
										"7": "8.770000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									},
									{
										"0": "7bcfb8f0-d3ec-4fa9-b1b3-6d46f05920f5",
										"1": "2",
										"2": "144",
										"3": 3,
										"4": "30.480000000000000000",
										"5": "91.440000000000000000",
										"6": "20191204",
										"7": "24.270000000000000000",
										"8": 6,
										"9": 2,
										"10": "92"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"1"
									],
									"isStacked": false
								}
							}
						}
					},
					"8ced192d-345e-41d1-b5a6-7da83bf1838c": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "106467",
										"1": "2575",
										"2": "90"
									},
									{
										"0": "106467",
										"1": "244",
										"2": "66"
									},
									{
										"0": "106467",
										"1": "446",
										"2": "71"
									},
									{
										"0": "106467",
										"1": "1179",
										"2": "85"
									},
									{
										"0": "106467",
										"1": "1383",
										"2": "31"
									},
									{
										"0": "106467",
										"1": "1072",
										"2": "57"
									},
									{
										"0": "106468",
										"1": "1478",
										"2": "7"
									},
									{
										"0": "106468",
										"1": "953",
										"2": "29"
									},
									{
										"0": "106468",
										"1": "986",
										"2": "45"
									},
									{
										"0": "106468",
										"1": "2660",
										"2": "87"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"48bb688f-891f-44e7-ac5b-3813eb203e2e": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80034",
										"1": "70",
										"2": "34.320000000000000000",
										"3": "1",
										"4": "73"
									},
									{
										"0": "80097",
										"1": "1160",
										"2": "105.040000000000000000",
										"3": "4",
										"4": "46"
									},
									{
										"0": "80126",
										"1": "30",
										"2": "62.400000000000000000",
										"3": "3",
										"4": "95"
									},
									{
										"0": "80145",
										"1": "4475",
										"2": "21.660000000000000000",
										"3": "1",
										"4": "40"
									},
									{
										"0": "80167",
										"1": "4097",
										"2": "69.990000000000000000",
										"3": "3",
										"4": "23"
									},
									{
										"0": "80168",
										"1": "169",
										"2": "77.580000000000000000",
										"3": "2",
										"4": "45"
									},
									{
										"0": "80177",
										"1": "3593",
										"2": "64.060000000000000000",
										"3": "2",
										"4": "97"
									},
									{
										"0": "80227",
										"1": "2169",
										"2": "19.270000000000000000",
										"3": "1",
										"4": "43"
									},
									{
										"0": "80228",
										"1": "1764",
										"2": "23.220000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "80233",
										"1": "1413",
										"2": "79.620000000000000000",
										"3": "3",
										"4": "74"
									},
									{
										"0": "80237",
										"1": "516",
										"2": "111.160000000000000000",
										"3": "4",
										"4": "98"
									},
									{
										"0": "80246",
										"1": "3533",
										"2": "66.420000000000000000",
										"3": "2",
										"4": "95"
									},
									{
										"0": "80247",
										"1": "925",
										"2": "94.020000000000000000",
										"3": "3",
										"4": "38"
									},
									{
										"0": "80253",
										"1": "2637",
										"2": "13.690000000000000000",
										"3": "1",
										"4": "14"
									},
									{
										"0": "80268",
										"1": "104",
										"2": "105.690000000000000000",
										"3": "3",
										"4": "54"
									},
									{
										"0": "80270",
										"1": "4288",
										"2": "228.970000000000000000",
										"3": "7",
										"4": "108"
									},
									{
										"0": "80283",
										"1": "31",
										"2": "44.300000000000000000",
										"3": "2",
										"4": "20"
									},
									{
										"0": "80296",
										"1": "202",
										"2": "96.920000000000000000",
										"3": "4",
										"4": "52"
									},
									{
										"0": "80318",
										"1": "169",
										"2": "155.160000000000000000",
										"3": "4",
										"4": "61"
									},
									{
										"0": "80331",
										"1": "162",
										"2": "64.420000000000000000",
										"3": "2",
										"4": "81"
									},
									{
										"0": "80347",
										"1": "4232",
										"2": "48.860000000000000000",
										"3": "2",
										"4": "89"
									},
									{
										"0": "80351",
										"1": "244",
										"2": "83.960000000000000000",
										"3": "4",
										"4": "83"
									},
									{
										"0": "80390",
										"1": "234",
										"2": "128.280000000000000000",
										"3": "4",
										"4": "72"
									},
									{
										"0": "80391",
										"1": "2942",
										"2": "29.410000000000000000",
										"3": "1",
										"4": "26"
									},
									{
										"0": "80394",
										"1": "3530",
										"2": "102.930000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "80412",
										"1": "3103",
										"2": "153.520000000000000000",
										"3": "4",
										"4": "24"
									},
									{
										"0": "80418",
										"1": "2280",
										"2": "67.040000000000000000",
										"3": "4",
										"4": "12"
									},
									{
										"0": "80432",
										"1": "3040",
										"2": "125.480000000000000000",
										"3": "4",
										"4": "19"
									},
									{
										"0": "80450",
										"1": "31",
										"2": "88.600000000000000000",
										"3": "4",
										"4": "67"
									},
									{
										"0": "80450",
										"1": "4069",
										"2": "58.320000000000000000",
										"3": "2",
										"4": "43"
									},
									{
										"0": "80460",
										"1": "64",
										"2": "93.840000000000000000",
										"3": "3",
										"4": "25"
									},
									{
										"0": "80477",
										"1": "46",
										"2": "25.910000000000000000",
										"3": "1",
										"4": "54"
									},
									{
										"0": "80506",
										"1": "3652",
										"2": "214.860000000000000000",
										"3": "6",
										"4": "50"
									},
									{
										"0": "80572",
										"1": "3833",
										"2": "144.240000000000000000",
										"3": "4",
										"4": "90"
									},
									{
										"0": "80606",
										"1": "1904",
										"2": "77.700000000000000000",
										"3": "3",
										"4": "74"
									},
									{
										"0": "80648",
										"1": "4903",
										"2": "146.940000000000000000",
										"3": "6",
										"4": "2"
									},
									{
										"0": "80659",
										"1": "2433",
										"2": "45.520000000000000000",
										"3": "2",
										"4": "63"
									},
									{
										"0": "80682",
										"1": "236",
										"2": "100.960000000000000000",
										"3": "4",
										"4": "75"
									},
									{
										"0": "80705",
										"1": "241",
										"2": "53.120000000000000000",
										"3": "2",
										"4": "31"
									},
									{
										"0": "80707",
										"1": "253",
										"2": "77.960000000000000000",
										"3": "4",
										"4": "57"
									},
									{
										"0": "80766",
										"1": "4333",
										"2": "105.900000000000000000",
										"3": "3",
										"4": "1"
									},
									{
										"0": "80769",
										"1": "122",
										"2": "54.020000000000000000",
										"3": "2",
										"4": "96"
									},
									{
										"0": "80769",
										"1": "1743",
										"2": "64.650000000000000000",
										"3": "3",
										"4": "71"
									},
									{
										"0": "80781",
										"1": "4617",
										"2": "109.720000000000000000",
										"3": "4",
										"4": "46"
									},
									{
										"0": "80801",
										"1": "2720",
										"2": "99.090000000000000000",
										"3": "3",
										"4": "120"
									},
									{
										"0": "80821",
										"1": "2478",
										"2": "21.950000000000000000",
										"3": "1",
										"4": "18"
									},
									{
										"0": "80848",
										"1": "1884",
										"2": "24.310000000000000000",
										"3": "1",
										"4": "30"
									},
									{
										"0": "80850",
										"1": "1980",
										"2": "356.720000000000000000",
										"3": "14",
										"4": "84"
									},
									{
										"0": "80867",
										"1": "3986",
										"2": "34.640000000000000000",
										"3": "1",
										"4": "44"
									},
									{
										"0": "80877",
										"1": "105",
										"2": "137.440000000000000000",
										"3": "4",
										"4": "70"
									},
									{
										"0": "80907",
										"1": "186",
										"2": "95.440000000000000000",
										"3": "4",
										"4": "25"
									},
									{
										"0": "80911",
										"1": "102",
										"2": "46.100000000000000000",
										"3": "2",
										"4": "22"
									},
									{
										"0": "80922",
										"1": "963",
										"2": "100.680000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "80966",
										"1": "134",
										"2": "58.320000000000000000",
										"3": "2",
										"4": "85"
									},
									{
										"0": "81009",
										"1": "4662",
										"2": "36.400000000000000000",
										"3": "1",
										"4": "53"
									},
									{
										"0": "81024",
										"1": "166",
										"2": "24.790000000000000000",
										"3": "1",
										"4": "72"
									},
									{
										"0": "81026",
										"1": "169",
										"2": "77.580000000000000000",
										"3": "2",
										"4": "2"
									},
									{
										"0": "81027",
										"1": "2158",
										"2": "43.460000000000000000",
										"3": "2",
										"4": "54"
									},
									{
										"0": "81029",
										"1": "2801",
										"2": "26.410000000000000000",
										"3": "1",
										"4": "79"
									},
									{
										"0": "81030",
										"1": "153",
										"2": "27.430000000000000000",
										"3": "1",
										"4": "99"
									},
									{
										"0": "81035",
										"1": "4097",
										"2": "93.320000000000000000",
										"3": "4",
										"4": "87"
									},
									{
										"0": "81121",
										"1": "167",
										"2": "28.690000000000000000",
										"3": "1",
										"4": "81"
									},
									{
										"0": "81149",
										"1": "180",
										"2": "103.240000000000000000",
										"3": "4",
										"4": "19"
									},
									{
										"0": "81180",
										"1": "109",
										"2": "311.880000000000000000",
										"3": "12",
										"4": "75"
									},
									{
										"0": "81182",
										"1": "606",
										"2": "73.230000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "81199",
										"1": "32",
										"2": "76.200000000000000000",
										"3": "2",
										"4": "80"
									},
									{
										"0": "81220",
										"1": "183",
										"2": "135.840000000000000000",
										"3": "4",
										"4": "78"
									},
									{
										"0": "81261",
										"1": "243",
										"2": "109.040000000000000000",
										"3": "4",
										"4": "38"
									},
									{
										"0": "81270",
										"1": "4583",
										"2": "111.120000000000000000",
										"3": "4",
										"4": "85"
									},
									{
										"0": "81281",
										"1": "1382",
										"2": "160.620000000000000000",
										"3": "6",
										"4": "160"
									},
									{
										"0": "81320",
										"1": "3673",
										"2": "88.040000000000000000",
										"3": "4",
										"4": "86"
									},
									{
										"0": "81331",
										"1": "213",
										"2": "87.210000000000000000",
										"3": "3",
										"4": "23"
									},
									{
										"0": "81349",
										"1": "91",
										"2": "62.500000000000000000",
										"3": "2",
										"4": "48"
									},
									{
										"0": "81352",
										"1": "4744",
										"2": "28.270000000000000000",
										"3": "1",
										"4": "18"
									},
									{
										"0": "81358",
										"1": "1588",
										"2": "80.760000000000000000",
										"3": "4",
										"4": "99"
									},
									{
										"0": "81386",
										"1": "4644",
										"2": "131.760000000000000000",
										"3": "4",
										"4": "59"
									},
									{
										"0": "81387",
										"1": "39",
										"2": "125.920000000000000000",
										"3": "4",
										"4": "34"
									},
									{
										"0": "81397",
										"1": "219",
										"2": "123.000000000000000000",
										"3": "4",
										"4": "42"
									},
									{
										"0": "81407",
										"1": "238",
										"2": "28.090000000000000000",
										"3": "1",
										"4": "97"
									},
									{
										"0": "81407",
										"1": "916",
										"2": "24.540000000000000000",
										"3": "1",
										"4": "96"
									},
									{
										"0": "81423",
										"1": "43",
										"2": "37.480000000000000000",
										"3": "1",
										"4": "69"
									},
									{
										"0": "81428",
										"1": "113",
										"2": "24.990000000000000000",
										"3": "1",
										"4": "8"
									},
									{
										"0": "81435",
										"1": "171",
										"2": "73.500000000000000000",
										"3": "3",
										"4": "53"
									},
									{
										"0": "81465",
										"1": "4072",
										"2": "109.520000000000000000",
										"3": "4",
										"4": "39"
									},
									{
										"0": "81524",
										"1": "49",
										"2": "69.900000000000000000",
										"3": "3",
										"4": "60"
									},
									{
										"0": "81524",
										"1": "604",
										"2": "68.160000000000000000",
										"3": "2",
										"4": "56"
									},
									{
										"0": "81561",
										"1": "93",
										"2": "39.880000000000000000",
										"3": "2",
										"4": "11"
									},
									{
										"0": "81562",
										"1": "1631",
										"2": "144.750000000000000000",
										"3": "5",
										"4": "102"
									},
									{
										"0": "81567",
										"1": "39",
										"2": "94.440000000000000000",
										"3": "3",
										"4": "12"
									},
									{
										"0": "81585",
										"1": "144",
										"2": "60.960000000000000000",
										"3": "2",
										"4": "49"
									},
									{
										"0": "81585",
										"1": "220",
										"2": "82.800000000000000000",
										"3": "3",
										"4": "81"
									},
									{
										"0": "81621",
										"1": "4654",
										"2": "70.180000000000000000",
										"3": "2",
										"4": "75"
									},
									{
										"0": "81633",
										"1": "1370",
										"2": "106.640000000000000000",
										"3": "4",
										"4": "98"
									},
									{
										"0": "81652",
										"1": "703",
										"2": "70.280000000000000000",
										"3": "2",
										"4": "77"
									},
									{
										"0": "81654",
										"1": "393",
										"2": "100.980000000000000000",
										"3": "3",
										"4": "56"
									},
									{
										"0": "81660",
										"1": "44",
										"2": "25.200000000000000000",
										"3": "2",
										"4": "84"
									},
									{
										"0": "81661",
										"1": "65",
										"2": "50.940000000000000000",
										"3": "3",
										"4": "57"
									},
									{
										"0": "81661",
										"1": "4654",
										"2": "35.090000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "81663",
										"1": "76",
										"2": "69.000000000000000000",
										"3": "3",
										"4": "4"
									},
									{
										"0": "81665",
										"1": "141",
										"2": "44.260000000000000000",
										"3": "2",
										"4": "58"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "TotalAmountDecember",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "TotalQuantityDecember",
										"type": "bigint"
									},
									{
										"key": "4",
										"name": "TotalItemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/3600cd0c-0725-4a38-8ac6-e135b659c5c8/resourceGroups/dp203/providers/Microsoft.Synapse/workspaces/asaworkspacedp203xb/bigDataPools/SparkPool01",
				"name": "SparkPool01",
				"type": "Spark",
				"endpoint": "https://asaworkspacedp203xb.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			}
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://wwi-02@asadatalakedp203xb.dfs.core.windows.net/sale-small/Year=2010/Quarter=Q4/Month=12/Day=20101231/sale-small-20101231-snappy.parquet', format='parquet')\r\n",
					"display(df.limit(10))"
				],
				"attachments": null,
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"profitByDateProduct = (df.groupBy(\"TransactionDate\",\"ProductId\")\r\n",
					"    .agg(\r\n",
					"        sum(\"ProfitAmount\").alias(\"(sum)ProfitAmount\"),\r\n",
					"        round(avg(\"Quantity\"), 4).alias(\"(avg)Quantity\"),\r\n",
					"        sum(\"Quantity\").alias(\"(sum)Quantity\"))\r\n",
					"    .orderBy(\"TransactionDate\"))\r\n",
					"display(profitByDateProduct.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"datalake = 'asadatalakedp203xb'\r\n",
					"df = (spark.read \\\r\n",
					"        .option('inferSchema', 'true') \\\r\n",
					"        .json('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/online-user-profiles-02/*.json', multiLine=True)\r\n",
					"    )\r\n",
					"\r\n",
					"df.printSchema()\r\n",
					""
				],
				"attachments": null,
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"df.createOrReplaceTempView(\"user_profiles\")\r\n",
					""
				],
				"attachments": null,
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"SELECT * FROM user_profiles LIMIT 10\r\n",
					""
				],
				"attachments": null,
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"from pyspark.sql.functions import udf, explode\r\n",
					"\r\n",
					"flat=df.select('visitorId',explode('topProductPurchases').alias('topProductPurchases_flat'))\r\n",
					"flat.show(100)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"topPurchases = (flat.select('visitorId','topProductPurchases_flat.productId','topProductPurchases_flat.itemsPurchasedLast12Months')\r\n",
					"    .orderBy('visitorId'))\r\n",
					"\r\n",
					"topPurchases.show(100)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 7
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Let's order by the number of items purchased in the last 12 months\r\n",
					"sortedTopPurchases = topPurchases.orderBy(\"itemsPurchasedLast12Months\")\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 8
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"sortedTopPurchases = (topPurchases\r\n",
					"    .orderBy( col(\"itemsPurchasedLast12Months\").desc() ))\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 9
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(count(\"*\").alias(\"total\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 10
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\",\"itemsPurchasedLast12Months\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(sum(\"itemsPurchasedLast12Months\").alias(\"totalItemsPurchased\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 11
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					"# Create a temporary view for top purchases so we can load from Scala\r\n",
					"topPurchases.createOrReplaceTempView(\"top_purchases\")\r\n",
					""
				],
				"attachments": null,
				"execution_count": 12
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					},
					"collapsed": true
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the dedcated SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df = spark.sqlContext.sql(\"select * from top_purchases\")\r\n",
					"df.write.sqlanalytics(\"SQLPool01.wwi.TopPurchases\", Constants.INTERNAL)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 13
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfsales = spark.read.load('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/*/*.parquet', format='parquet')\r\n",
					"display(dfsales.limit(10))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					},
					"collapsed": true
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df2 = spark.read.sqlanalytics(\"SQLPool01.wwi.TopPurchases\")\r\n",
					"df2.createTempView(\"top_purchases_sql\")\r\n",
					"\r\n",
					"df2.head(10)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 15
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfTopPurchasesFromSql = sqlContext.table(\"top_purchases_sql\")\r\n",
					"\r\n",
					"display(dfTopPurchasesFromSql.limit(10))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"inner_join = dfsales.join(dfTopPurchasesFromSql,\r\n",
					"    (dfsales.CustomerId == dfTopPurchasesFromSql.visitorId) & (dfsales.ProductId == dfTopPurchasesFromSql.productId))\r\n",
					"\r\n",
					"inner_join_agg = (inner_join.select(\"CustomerId\",\"TotalAmount\",\"Quantity\",\"itemsPurchasedLast12Months\",\"top_purchases_sql.productId\")\r\n",
					"    .groupBy([\"CustomerId\",\"top_purchases_sql.productId\"])\r\n",
					"    .agg(\r\n",
					"        sum(\"TotalAmount\").alias(\"TotalAmountDecember\"),\r\n",
					"        sum(\"Quantity\").alias(\"TotalQuantityDecember\"),\r\n",
					"        sum(\"itemsPurchasedLast12Months\").alias(\"TotalItemsPurchasedLast12Months\"))\r\n",
					"    .orderBy(\"CustomerId\") )\r\n",
					"\r\n",
					"display(inner_join_agg.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 17
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": true
				},
				"source": [
					""
				],
				"attachments": null,
				"execution_count": null
			}
		]
	}
}