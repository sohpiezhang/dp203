{
	"name": "User Profile HTAP",
	"properties": {
		"content": {
			"query": "USE master\nGO\n\nIF DB_ID (N'Profiles') IS NULL\nBEGIN\n    CREATE DATABASE Profiles;\nEND\nGO\n\nUSE Profiles\nGO\n\nDROP VIEW IF EXISTS UserProfileHTAP;\nGO\n\nCREATE VIEW UserProfileHTAP\nAS\nSELECT\n    *\nFROM OPENROWSET(\n    'CosmosDB',\n    N'account=asacosmosdbdp203xb;database=CustomerProfile;key=PASSFUSxVhgxCKAfbaGGthvsGhjJAdT8oms8C5IbSkOQq0hLtrs2IzoTRaBDHhSO43MYVYchPK5yaZsVBSa9qA==',\n    UserProfileHTAP\n)\nWITH (\n    userId bigint,\n    cartId varchar(50),\n    preferredProducts varchar(max),\n    productReviews varchar(max)\n) AS profiles\nCROSS APPLY OPENJSON (productReviews)\nWITH (\n    productId bigint,\n    reviewText varchar(1000)\n) AS reviews\nGO\n\n-- 1. Once Azure Synapse Link is configured on Cosmos DB, what is the first step to perform to use Azure Synapse Analytics serverless SQL pools to query the Azure Cosmos DB data?\n\n-- Use the OPENROWSET function\n\n-- Create a database\n-- Correct. Before being able to issue any queries using Azure Synapse Analytics serverless SQL pools, you first must create a database.\n\n-- Use a SELECT clause.\n-- 2. What function provides a rowset view over a JSON document?\n\n-- OPENROWSET.\n\n-- OPENJSON.\n-- Correct. The OPENJSON function provides a rowset view over a JSON document.\n\n-- WITH.\n\n-- 2. How do you disable Azure Synapse Link for Azure Cosmos DB?\n\n-- Delete the Azure Cosmos DB container.\n\n-- Delete the Azure Cosmos DB account.\n-- Correct. Deleting the Azure Cosmos DB account with disable and remove Azure Synapse Link.\n\n-- Set the Azure Synpase Link option to disable on the Azure Cosmos DB container.",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "Profiles",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}